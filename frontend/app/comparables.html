<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparables - Claim Cipher</title>
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body class="theme-dark">
    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar__header">
            <div class="sidebar__logo">
                <a href="./dashboard.html">Claim Cipher</a>
            </div>
        </div>
        
        <ul class="sidebar__nav">
            <li class="sidebar__nav-item">
                <a href="./dashboard.html" class="sidebar__nav-link">
                    <span>üìä</span> Dashboard
                </a>
            </li>
            <li class="sidebar__nav-item">
                <a href="./mileage.html" class="sidebar__nav-link">
                    <span>üöó</span> Mileage Calculator
                </a>
            </li>
            <li class="sidebar__nav-item">
                <a href="./routes.html" class="sidebar__nav-link">
                    <span>üó∫Ô∏è</span> Route Optimizer
                </a>
            </li>
            <li class="sidebar__nav-item">
                <a href="./jobs.html" class="sidebar__nav-link">
                    <span>üì±</span> Mobile Sync
                    <span class="badge badge--pro">PRO</span>
                </a>
            </li>
            <li class="sidebar__nav-item">
                <a href="./autoforms.html" class="sidebar__nav-link">
                    <span>üìÑ</span> AutoForms
                </a>
            </li>
            <li class="sidebar__nav-item">
                <a href="./comparables.html" class="sidebar__nav-link sidebar__nav-link--active">
                    <span>üîç</span> Comparables
                    <span class="badge badge--pro">PRO</span>
                </a>
            </li>
            <li class="sidebar__nav-item">
                <a href="./firms.html" class="sidebar__nav-link">
                    <span>üè¢</span> Firms Directory
                </a>
            </li>
            <li class="sidebar__nav-item">
                <a href="./gear.html" class="sidebar__nav-link">
                    <span>‚öôÔ∏è</span> Gear
                </a>
            </li>
            <li class="sidebar__nav-item">
                <a href="./help.html" class="sidebar__nav-link">
                    <span>‚ùì</span> Help
                </a>
            </li>
            <li class="sidebar__nav-item">
                <a href="./settings.html" class="sidebar__nav-link">
                    <span>‚öôÔ∏è</span> Settings
                </a>
            </li>
        </ul>
        
        <!-- User info and logout -->
        <div class="sidebar__footer">
            <div class="sidebar__user" id="sidebar-user">
                <div class="user-avatar" id="user-avatar">DU</div>
                <div class="user-info">
                    <div class="user-name" id="user-name">Demo User</div>
                    <div class="user-role" id="user-role">Demo Mode</div>
                </div>
            </div>
            <button class="sidebar__logout btn btn--ghost btn--sm" id="logout-btn">
                <span>üö™</span> Logout
            </button>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="main-content">
        <div class="page-header">
            <h1 class="page-title">Vehicle Comparables</h1>
            <p class="page-subtitle">Find similar vehicles from multiple sources</p>
            <span class="badge badge--pro">PRO FEATURE</span>
        </div>

        <!-- Search Form -->
        <div class="card mb-4">
            <div class="card__header">
                <h3 class="card__title">üîç Search for Comparables</h3>
                <span class="text-sm text-muted">Find similar vehicles in your area</span>
            </div>
            <div class="card__content">
                <form class="grid grid--2" id="comparables-form">
                    <div class="input-group">
                        <label class="input-label">Vehicle Year</label>
                        <input type="number" class="input" placeholder="2021" min="1990" max="2025">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Make</label>
                        <input type="text" class="input" placeholder="Honda">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Model</label>
                        <input type="text" class="input" placeholder="Accord">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Trim Level</label>
                        <input type="text" class="input" placeholder="Sport">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Mileage Range</label>
                        <select class="input">
                            <option value="">Any Mileage</option>
                            <option value="0-25000">0 - 25,000 miles</option>
                            <option value="25000-50000">25,000 - 50,000 miles</option>
                            <option value="50000-75000">50,000 - 75,000 miles</option>
                            <option value="75000-100000">75,000 - 100,000 miles</option>
                            <option value="100000+">100,000+ miles</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">ZIP Code</label>
                        <input type="text" class="input" placeholder="27601" pattern="[0-9]{5}">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Search Radius</label>
                        <select class="input">
                            <option value="25">25 miles</option>
                            <option value="50" selected>50 miles</option>
                            <option value="100">100 miles</option>
                            <option value="200">200 miles</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Condition</label>
                        <select class="input">
                            <option value="">Any Condition</option>
                            <option value="excellent">Excellent</option>
                            <option value="good">Good</option>
                            <option value="fair">Fair</option>
                            <option value="poor">Poor</option>
                        </select>
                    </div>
                </form>
                
                <div class="flex gap-2 mt-4">
                    <button type="submit" class="btn btn--primary" form="comparables-form">
                        üîç Search Comparables
                    </button>
                    <button type="reset" class="btn btn--outline" form="comparables-form">
                        Clear Form
                    </button>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="card" id="comparables-results" style="display: none;">
            <div class="card__header">
                <h3 class="card__title">üìã Comparable Vehicles Found</h3>
                <div class="flex gap-2">
                    <span class="text-sm text-muted">12 vehicles found</span>
                    <button class="btn btn--success btn--sm" id="export-comparables-pdf">
                        üìÑ Export PDF
                    </button>
                </div>
            </div>
            
            <div class="card__content">
                <div class="comparables-grid">
                    <div class="comparable-card">
                        <div class="comparable-header">
                            <h4 class="comparable-title">2021 Honda Accord Sport</h4>
                            <span class="comparable-price">$28,500</span>
                        </div>
                        <div class="comparable-details">
                            <div class="detail-row">
                                <span class="detail-label">Mileage:</span>
                                <span class="detail-value">42,350 miles</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Location:</span>
                                <span class="detail-value">Durham, NC (18 miles)</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Condition:</span>
                                <span class="detail-value">Good</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Source:</span>
                                <span class="detail-value">AutoTrader</span>
                            </div>
                        </div>
                        <div class="comparable-actions">
                            <button class="btn btn--outline btn--sm">View Details</button>
                            <button class="btn btn--primary btn--sm">Add to Report</button>
                        </div>
                    </div>

                    <div class="comparable-card">
                        <div class="comparable-header">
                            <h4 class="comparable-title">2021 Honda Accord Sport</h4>
                            <span class="comparable-price">$27,800</span>
                        </div>
                        <div class="comparable-details">
                            <div class="detail-row">
                                <span class="detail-label">Mileage:</span>
                                <span class="detail-value">38,125 miles</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Location:</span>
                                <span class="detail-value">Cary, NC (12 miles)</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Condition:</span>
                                <span class="detail-value">Excellent</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Source:</span>
                                <span class="detail-value">Cars.com</span>
                            </div>
                        </div>
                        <div class="comparable-actions">
                            <button class="btn btn--outline btn--sm">View Details</button>
                            <button class="btn btn--primary btn--sm">Add to Report</button>
                        </div>
                    </div>

                    <div class="comparable-card">
                        <div class="comparable-header">
                            <h4 class="comparable-title">2020 Honda Accord Sport</h4>
                            <span class="comparable-price">$26,900</span>
                        </div>
                        <div class="comparable-details">
                            <div class="detail-row">
                                <span class="detail-label">Mileage:</span>
                                <span class="detail-value">51,280 miles</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Location:</span>
                                <span class="detail-value">Chapel Hill, NC (25 miles)</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Condition:</span>
                                <span class="detail-value">Good</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Source:</span>
                                <span class="detail-value">CarGurus</span>
                            </div>
                        </div>
                        <div class="comparable-actions">
                            <button class="btn btn--outline btn--sm">View Details</button>
                            <button class="btn btn--primary btn--sm">Add to Report</button>
                        </div>
                    </div>
                </div>

                <!-- Summary Statistics -->
                <div class="comparables-summary mt-4">
                    <div class="summary-stats">
                        <div class="stat-card">
                            <div class="stat-value">$27,733</div>
                            <div class="stat-label">Average Price</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">43,918</div>
                            <div class="stat-label">Average Miles</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">32</div>
                            <div class="stat-label">Avg Distance</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">12</div>
                            <div class="stat-label">Total Found</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script src="../assets/js/helpers.js"></script>
    
    <!-- Authentication and initialization script -->
    <script>
        // Authentication check
        if (localStorage.getItem('isAuthenticated') !== 'true') {
            window.location.href = '../login.html';
        }

        // Initialize page with user context
        document.addEventListener('DOMContentLoaded', function() {
            initializeUserContext();
            setupLogoutHandler();
            initializeComparables();
        });

        function initializeUserContext() {
            const userType = localStorage.getItem('userType') || 'demo';
            const userEmail = localStorage.getItem('userEmail') || 'demo@example.com';
            const userName = userType === 'demo' ? 'Demo User' : userEmail.split('@')[0];
            
            // Set user type attribute
            document.body.setAttribute('data-user-type', userType);
            
            // Update user display
            const userNameEl = document.getElementById('user-name');
            const userRoleEl = document.getElementById('user-role');
            const userAvatarEl = document.getElementById('user-avatar');
            
            if (userNameEl) userNameEl.textContent = userName;
            if (userRoleEl) userRoleEl.textContent = userType === 'demo' ? 'Demo Mode' : 'Pro User';
            if (userAvatarEl) userAvatarEl.textContent = userName.substring(0, 2).toUpperCase();
        }

        function setupLogoutHandler() {
            const logoutBtn = document.getElementById('logout-btn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function() {
                    localStorage.removeItem('isAuthenticated');
                    localStorage.removeItem('userType');
                    localStorage.removeItem('userEmail');
                    localStorage.removeItem('demoStartTime');
                    window.location.href = '../login.html';
                });
            }
        }

        function initializeComparables() {
            const form = document.getElementById('comparables-form');
            const resultsDiv = document.getElementById('comparables-results');
            const exportBtn = document.getElementById('export-comparables-pdf');
            
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Demo behavior - show results
                    if (resultsDiv) {
                        resultsDiv.style.display = 'block';
                        resultsDiv.scrollIntoView({ behavior: 'smooth' });
                    }
                    
                    showToast('Comparables search completed! 12 vehicles found.', 'success');
                });
            }
            
            if (exportBtn) {
                exportBtn.addEventListener('click', function() {
                    showToast('PDF export is a demo feature', 'info');
                });
            }
        }
    </script>
</body>
</html>
