<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Route Optimizer - Claim Cipher</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../styles/normalize.css">
    <link rel="stylesheet" href="../styles/variables.css">
    <link rel="stylesheet" href="../styles/components/header.css">
    <link rel="stylesheet" href="../styles/components/sidebar.css">
    <link rel="stylesheet" href="../styles/components/cards.css">
    <link rel="stylesheet" href="../styles/components/buttons.css">
    <link rel="stylesheet" href="../styles/components/forms.css">
    <link rel="stylesheet" href="../styles/components/navigation.css">
    <link rel="stylesheet" href="../styles/pages/routes.css">
    <link rel="stylesheet" href="../styles/index.css">
</head>
<body>
    <!-- Demo Banner will be injected by navigation.js -->

    <!-- Sidebar Navigation -->
    <!-- Navigation will be injected by navigation.js -->


    <!-- Main Content Area -->
    <main class="main">
        <div class="page-routes">
            <header class="main__header">
                <h1 class="main__title">Route Optimizer</h1>
                <p class="main__subtitle">Group stops within 50-mile radius and optimize your daily routes</p>
            </header>

            <div class="card">
                <div class="route-controls">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Start Address</label>
                            <input type="text" class="form-input" value="Home" placeholder="Enter starting location">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Route Rules</label>
                            <div class="rule-badges">
                                <span class="badge" id="radius-badge">Max 50mi radius</span>
                                <span class="badge" id="stops-badge">Max 10 stops/day</span>
                                <span class="badge" id="spillover-badge">Spillover: Tomorrow</span>
                                <button class="btn btn--secondary btn--small" id="edit-rules-btn">Edit Rules</button>
                            </div>
                        </div>
                    </div>

                    <div class="add-stop-form">
                        <div class="form-group">
                            <label class="form-label">Add Stops</label>
                            <div class="input-group">
                                <input type="text" class="form-input" placeholder="Enter address or claim location" id="new-stop-address">
                                <input type="text" class="form-input" placeholder="Claim #" id="new-stop-claim" style="width: 120px;">
                                <button class="btn btn--primary" id="add-stop-btn">Add Stop</button>
                            </div>
                        </div>
                    </div>

                    <div class="route-actions">
                        <button class="btn btn--secondary" id="import-csv-btn">üì§ Import CSV</button>
                        <button class="btn btn--primary" id="optimize-routes-btn">üéØ Optimize Routes</button>
                    </div>
                </div>
            </div>

            <div class="map-container">
                <div class="map-placeholder">
                    <div class="map-icon">üó∫Ô∏è</div>
                    <div>Interactive map will display optimized routes with color-coded polylines</div>
                </div>
            </div>

            <!-- Route Optimization Results -->
            <div class="route-results" id="route-results" style="display: none;">
                <div class="route-tabs" id="route-tabs">
                    <!-- Dynamic tabs will be inserted here -->
                </div>
                
                <div class="route-day-content">
                    <div class="route-day-header">
                        <h3 id="current-day-title">Day 1</h3>
                        <div class="route-summary" id="route-summary">
                            <span id="total-miles">0 miles</span> ‚Ä¢ 
                            <span id="total-time">0 hours</span> ‚Ä¢ 
                            <span id="total-amount">$0.00</span>
                        </div>
                    </div>
                    
                    <div class="route-stops-container" id="route-stops-container">
                        <!-- Route stops will be dynamically inserted here -->
                    </div>
                </div>
                
                <div class="route-actions-secondary">
                    <button class="btn btn--secondary" id="sync-calendar-btn">üìÖ Sync to Calendar</button>
                    <button class="btn btn--secondary" id="export-pdf-btn">üìÑ Export PDF</button>
                    <button class="btn btn--secondary" id="clear-stops-btn">üóëÔ∏è Clear All</button>
                </div>
            </div>

            <!-- Route Overview Card -->
            <div class="card">
                <div class="card__header">
                    <h3>Route Overview</h3>
                </div>
                <div class="route-overview">
                    <div class="overview-stats">
                        <div class="overview-stat">
                            <span class="stat-number" id="total-days">0</span>
                            <span class="stat-label">Days</span>
                        </div>
                        <div class="overview-stat">
                            <span class="stat-number" id="total-stops-count">0</span>
                            <span class="stat-label">Total Stops</span>
                        </div>
                        <div class="overview-stat">
                            <span class="stat-number" id="overview-total-miles">0</span>
                            <span class="stat-label">Miles</span>
                        </div>
                    </div>
                    <div class="overview-rules">
                        <div class="rule-item">
                            <span class="rule-label">Max Radius:</span>
                            <span id="current-radius">50 miles</span>
                        </div>
                        <div class="rule-item">
                            <span class="rule-label">Max Stops/Day:</span>
                            <span id="current-max-stops">10 stops</span>
                        </div>
                        <div class="rule-item">
                            <span class="rule-label">Spillover:</span>
                            <span id="current-spillover">tomorrow</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Rules Modal -->
            <div class="modal" id="rules-modal" style="display: none;">
                <div class="modal__content">
                    <div class="modal__header">
                        <h3>Route Rules</h3>
                        <button class="modal__close" id="close-rules-modal">&times;</button>
                    </div>
                    <form id="rules-form" class="modal__body">
                        <div class="form-group">
                            <label class="form-label" for="max-radius">Maximum Radius (miles)</label>
                            <input type="number" id="max-radius" name="max-radius" class="form-input" min="10" max="200" value="50">
                            <div class="form-help">Group stops within this radius (10-200 miles)</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="max-stops">Maximum Stops per Day</label>
                            <input type="number" id="max-stops" name="max-stops" class="form-input" min="1" max="30" value="10">
                            <div class="form-help">Limit daily stops for optimal efficiency (1-30 stops)</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="spillover-rule">Spillover Rule</label>
                            <select id="spillover-rule" name="spillover-rule" class="form-select">
                                <option value="tomorrow">Tomorrow</option>
                                <option value="next-week">Next Week</option>
                                <option value="skip">Skip</option>
                            </select>
                            <div class="form-help">How to handle extra stops beyond daily limit</div>
                        </div>
                    </form>
                    <div class="modal__footer">
                        <button class="btn btn--secondary" id="cancel-rules-btn">Cancel</button>
                        <button class="btn btn--primary" id="save-rules-btn">Save Rules</button>
                    </div>
                </div>
            </div>

            <!-- CSV Import (hidden) -->
            <input type="file" id="route-csv-input" accept=".csv" style="display: none;">
        </div>
    </main>

    <!-- Toast Notification (hidden by default) -->
    <div class="toast" id="toast">
        <div style="display: flex; align-items: center; gap: 12px;">
            <span></span>
            <div>
                <div style="font-weight: 600;">Success!</div>
                <div style="font-size: 14px; color: var(--text-secondary);">Route optimized successfully</div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../scripts/utils/constants.js"></script>
    <script src="../scripts/utils/helpers.js"></script>
    <script src="../scripts/utils/auth.js"></script>
    <script src="../scripts/utils/transitions.js"></script>
    <script src="../scripts/components/demo-banner.js"></script>
    <script src="../scripts/components/toast.js"></script>
    <script type="module" src="../scripts/components/navigation.js"></script>
    <script src="../scripts/pages/routes.js"></script>
</body>
</html>